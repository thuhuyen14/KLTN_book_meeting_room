<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Thống kê hệ thống - DNSE</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <link rel="stylesheet" href="css/style.css">

  <style>
    /* --- CSS CHO DASHBOARD --- */
    body { background-color: #f8f9fc; font-family: 'Segoe UI', sans-serif; }

    /* KPI Cards */
    .stat-card { border-left: 4px solid; transition: transform 0.2s; border-radius: 0.35rem; border: 0; box-shadow: 0 0.15rem 1.75rem 0 rgba(58,59,69,0.15); }
    .stat-card:hover { transform: translateY(-3px); }
    .stat-card .card-body { padding: 1.25rem; }
    .stat-title { font-size: 0.7rem; font-weight: 700; text-transform: uppercase; margin-bottom: 0.25rem; letter-spacing: 0.05em; }
    .stat-value { font-size: 1.5rem; font-weight: 700; color: #5a5c69; margin-bottom: 0; }
    .stat-icon { font-size: 2rem; opacity: 0.2; }

    /* Màu sắc KPI */
    .border-primary { border-left-color: #4e73df !important; } .text-primary { color: #4e73df !important; }
    .border-success { border-left-color: #1cc88a !important; } .text-success { color: #1cc88a !important; }
    .border-info { border-left-color: #36b9cc !important; } .text-info { color: #36b9cc !important; }
    .border-warning { border-left-color: #f6c23e !important; } .text-warning { color: #f6c23e !important; }

    /* Chart Cards */
    .chart-card { border: 0; box-shadow: 0 0.15rem 1.75rem 0 rgba(58,59,69,0.15); border-radius: 0.5rem; margin-bottom: 1.5rem; height: 100%; }
    .chart-header { background: #fff; border-bottom: 1px solid #e3e6f0; padding: 1rem 1.25rem; display: flex; justify-content: space-between; align-items: center; border-top-left-radius: 0.5rem; border-top-right-radius: 0.5rem; }
    .chart-header h6 { margin: 0; font-weight: bold; color: #4e73df; }
    .chart-body { padding: 1.25rem; position: relative; }

    /* Filter Toolbar */
    .filter-toolbar { background: white; padding: 10px 15px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); display: flex; align-items: center; gap: 15px; flex-wrap: wrap; }
    .filter-label { font-weight: 600; color: #555; font-size: 0.9rem; }
    
    /* Tabs */
    .nav-tabs .nav-link { color: #858796; font-weight: 500; border: none; border-bottom: 2px solid transparent; padding: 10px 20px; }
    .nav-tabs .nav-link:hover { border-color: transparent; color: #4e73df; }
    .nav-tabs .nav-link.active { color: #4e73df; border: none; border-bottom: 3px solid #4e73df; background: transparent; }
  </style>
</head>

<body>
  <div id="navbar-placeholder"></div>

  <main class="container-fluid px-4 my-4">
    
    <div class="mb-3">
        <h2 class="h3 text-gray-800 fw-bold"><i class="bi bi-speedometer2"></i> Dashboard Thống kê</h2>
        <p class="text-muted small">Tổng hợp dữ liệu hoạt động toàn hệ thống</p>
    </div>

    <div class="filter-toolbar mb-4">
        <div class="d-flex align-items-center">
            <i class="bi bi-funnel-fill text-primary me-2"></i>
            <span class="filter-label">Bộ lọc:</span>
        </div>

        <div class="btn-group btn-group-sm" role="group">
            <button type="button" class="btn btn-outline-secondary" onclick="quickFilter('7days')">7 ngày qua</button>
            <button type="button" class="btn btn-outline-secondary" onclick="quickFilter('thisMonth')">Tháng này</button>
            <button type="button" class="btn btn-outline-secondary" onclick="quickFilter('lastMonth')">Tháng trước</button>
        </div>

        <div class="vr mx-2"></div> <div class="d-flex align-items-center gap-2">
            <span class="small text-muted">Từ:</span>
            <input type="date" id="startDate" class="form-control form-control-sm" style="width: auto;">
            
            <span class="small text-muted">Đến:</span>
            <input type="date" id="endDate" class="form-control form-control-sm" style="width: auto;">
        </div>

        <button class="btn btn-primary btn-sm px-3 ms-auto" id="btnFilter">
            <i class="bi bi-search"></i> Xem dữ liệu
        </button>
    </div>

    <div class="row g-4 mb-4">
        <div class="col-xl-3 col-md-6">
            <div class="card stat-card border-primary h-100">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="stat-title text-primary">Cuộc họp</div>
                            <div class="stat-value" id="kpiMeetings">...</div>
                        </div>
                        <div class="col-auto"><i class="bi bi-calendar-event stat-icon text-primary"></i></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6">
            <div class="card stat-card border-success h-100">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="stat-title text-success">Văn bản trình ký</div>
                            <div class="stat-value" id="kpiDocs">...</div>
                        </div>
                        <div class="col-auto"><i class="bi bi-file-earmark-check stat-icon text-success"></i></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6">
            <div class="card stat-card border-info h-100">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="stat-title text-info">Người dùng Active</div>
                            <div class="stat-value" id="kpiUsers">...</div>
                        </div>
                        <div class="col-auto"><i class="bi bi-people-fill stat-icon text-info"></i></div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-xl-3 col-md-6">
            <div class="card stat-card shadow h-100 py-2" style="border-left: 4px solid #f6c23e;">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="stat-title text-warning">Công suất phòng</div>
                            <div class="row no-gutters align-items-center">
                                <div class="col-auto">
                                    <div class="stat-value me-3" id="kpiOccupancy">0%</div>
                                </div>
                                <div class="col">
                                    <div class="progress progress-sm mr-2">
                                        <div class="progress-bar bg-warning" id="kpiOccupancyBar" role="progressbar" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-auto"><i class="bi bi-battery-charging stat-icon text-warning"></i></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <ul class="nav nav-tabs mb-4" id="reportTabs" role="tablist">
      <li class="nav-item"><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#overview"><i class="bi bi-grid-1x2"></i> Tổng quan</button></li>
      <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#meeting"><i class="bi bi-calendar-week"></i> Phân tích Đặt phòng</button></li>
      <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#approve"><i class="bi bi-pen"></i> Phân tích Trình ký</button></li>
    </ul>

    <div class="tab-content">
      <div class="tab-pane fade show active" id="overview">
        <div class="row">
            <div class="col-lg-12">
                <div class="card chart-card">
                    <div class="chart-header"><h6>Tổng quan hoạt động hệ thống</h6></div>
                    <div class="chart-body"><canvas id="systemActivityChart" style="height: 350px;"></canvas></div>
                </div>
            </div>
        </div>
      </div>
      <div class="tab-pane fade" id="meeting">
        <div class="row">
           <div class="col-lg-6">
                <div class="card chart-card">
                    <div class="chart-header"><h6>Tần suất sử dụng phòng</h6></div>
                    <div class="chart-body"><canvas id="roomChart"></canvas></div>
                </div>
           </div>
           <div class="col-lg-6">
                <div class="card chart-card">
                    <div class="chart-header"><h6>Phân bổ theo ngày trong tuần</h6></div>
                    <div class="chart-body"><canvas id="dayChart"></canvas></div>
                </div>
           </div>
           <div class="col-lg-6">
                <div class="card chart-card">
                    <div class="chart-header"><h6>Khung giờ cao điểm</h6></div>
                    <div class="chart-body"><canvas id="hourChart"></canvas></div>
                </div>
           </div>
           <div class="col-lg-6">
                <div class="card chart-card">
                    <div class="chart-header"><h6>Top nhân viên đặt phòng</h6></div>
                    <div class="chart-body"><canvas id="userChart"></canvas></div>
                </div>
           </div>
        </div>
      </div>
      <div class="tab-pane fade" id="approve">
        <div class="row">
          <div class="col-md-6">
             <div class="card chart-card">
                <div class="chart-header"><h6>Tỷ lệ trạng thái văn bản</h6></div>
                <div class="chart-body d-flex justify-content-center"><canvas id="signStatusChart" style="max-height:300px"></canvas></div>
             </div>
          </div>
          <div class="col-md-6">
             <div class="card chart-card">
                <div class="chart-header"><h6>Top lãnh đạo ký duyệt</h6></div>
                <div class="chart-body"><canvas id="signerChart"></canvas></div>
             </div>
          </div>
        </div>

        <div class="row mt-4">
          <div class="col-md-12">
             <div class="card chart-card">
                <div class="chart-header"><h6>Xu hướng trình ký</h6></div>
                <div class="chart-body"><canvas id="signDayChart" style="max-height: 350px;"></canvas></div>
             </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <footer class="bg-white sticky-footer p-3 shadow-sm mt-5">
     <div class="container text-center">
        <img src="images/dnse_logo_notext.png" alt="DNSE" style="height:25px; opacity:0.8">
        <div class="small text-muted mt-1">&copy; 2025 DNSE Analytics Dashboard</div>
     </div>
  </footer>

  <!-- Scripts -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="js/navbar.js"></script>
  <script>
    $(document).ready(function() {
      $("#navbar-placeholder").load("navbar.html?v=" + Math.random(), function(){ if(typeof initNavbar === "function") initNavbar(); });
    });
  </script>

  <script src="js/analytic.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="js/main.js"></script>
</body>
</html>